# ç¢³æ±‡ç›‘æµ‹Webåº”ç”¨ - éœ€æ±‚æ–‡æ¡£

## é¡¹ç›®æ¦‚è¿°

åŸºäºFastAPI + Vue3/Vite + Docker + PostgreSQLå¼€å‘çš„ç¢³æ±‡ç›‘æµ‹Webåº”ç”¨ï¼Œå®ç°ç¢³æ±‡ç›‘æµ‹åŒºçš„åˆ›å»ºã€ç®¡ç†å’Œå®æ—¶æ•°æ®å±•ç¤ºã€‚

## å½“å‰å¼€å‘çŠ¶æ€

### å·²å®Œæˆ (Phase 1-3)
- **é¡¹ç›®æ¶æ„**: å®Œæ•´çš„ç›®å½•ç»“æ„å’ŒDockeré…ç½®
- **åç«¯API**: FastAPI + SQLAlchemy + PostgreSQL + JWTè®¤è¯
- **å‰ç«¯ç•Œé¢**: Vue3 + Vite + Element Plus + ç™»å½•/æ³¨å†Œ/Dashboardå¸ƒå±€
- **æ•°æ®åº“**: 4ä¸ªæ ¸å¿ƒæ•°æ®è¡¨è®¾è®¡å’Œåˆå§‹åŒ–è„šæœ¬

### è¿›è¡Œä¸­ (Phase 4)
- **åœ°å›¾äº¤äº’**: Leafletåœ°å›¾é›†æˆå’Œç›‘æµ‹åŒºåˆ›å»ºåŠŸèƒ½
- **æ•°æ®å¯è§†åŒ–**: NDVIå’Œç¢³å¸æ”¶é‡è¶‹åŠ¿å›¾è¡¨
- **æ¨¡æ‹Ÿæ•°æ®**: è‡ªåŠ¨ç”Ÿæˆç›‘æµ‹æ•°æ®æœåŠ¡

### å¾…å®Œæˆ (Phase 5)
- **ç”Ÿäº§éƒ¨ç½²**: ç¯å¢ƒé…ç½®å’Œæ€§èƒ½ä¼˜åŒ–
- **ç›‘æ§å‘Šè­¦**: å¼‚å¸¸æ£€æµ‹å’Œæ—¥å¿—è®°å½•

### æœåŠ¡è¿è¡ŒçŠ¶æ€
- **åç«¯API**: http://localhost:8001 (è¿è¡Œä¸­)
- **å‰ç«¯ç•Œé¢**: http://localhost:3000 (è¿è¡Œä¸­)
- **æ•°æ®åº“**: PostgreSQL (è¿è¡Œä¸­)
- **APIæ–‡æ¡£**: http://localhost:8001/docs (å¯ç”¨)

### å¿«é€Ÿå¼€å§‹

```bash
# 1. å¯åŠ¨æ•°æ®åº“
docker-compose up -d db

# 2. å®‰è£…åç«¯ä¾èµ–å¹¶å¯åŠ¨
cd backend
pip install -r requirements.txt
uvicorn app.main:app --reload --host 0.0.0.0 --port 8000

# 3. å®‰è£…å‰ç«¯ä¾èµ–å¹¶å¯åŠ¨ (æ–°ç»ˆç«¯)
cd frontend
npm install
npm run dev
```

### é»˜è®¤ç®¡ç†å‘˜è´¦æˆ·
- **ç”¨æˆ·å**: `admin`
- **å¯†ç **: `Admin123`

### å·²å®ç°APIæ¥å£

#### ç”¨æˆ·è®¤è¯
- `POST /api/auth/register` - ç”¨æˆ·æ³¨å†Œ
- `POST /api/auth/login` - ç”¨æˆ·ç™»å½•

#### ç¢³æ±‡ç›‘æµ‹åŒº
- `GET /api/zones/` - è·å–ç”¨æˆ·ç›‘æµ‹åŒºåˆ—è¡¨
- `POST /api/zones/` - åˆ›å»ºç›‘æµ‹åŒº
- `GET /api/zones/{zone_id}` - è·å–å•ä¸ªç›‘æµ‹åŒºè¯¦æƒ…
- `PUT /api/zones/{zone_id}` - æ›´æ–°ç›‘æµ‹åŒº
- `DELETE /api/zones/{zone_id}` - åˆ é™¤ç›‘æµ‹åŒº

#### ç›‘æµ‹æ•°æ®
- `GET /api/measurements/zone/{zone_id}` - è·å–åŒºåŸŸç›‘æµ‹æ•°æ®
- `GET /api/measurements/zone/{zone_id}/chart` - è·å–å›¾è¡¨æ•°æ®
- `POST /api/measurements/` - åˆ›å»ºç›‘æµ‹æ•°æ®

#### ä»·æ ¼æ•°æ®
- `GET /api/prices/current` - è·å–å½“å‰ç¢³æ±‡ä»·æ ¼
- `GET /api/prices/history` - è·å–ä»·æ ¼å†å²
- `POST /api/prices/generate-mock` - ç”Ÿæˆæ¨¡æ‹Ÿä»·æ ¼

## æŠ€æœ¯æ ˆ

- **åç«¯**: FastAPI + SQLAlchemy + PostgreSQL + JWTè®¤è¯
- **å‰ç«¯**: Vue3 + Vite + Leafletåœ°å›¾åº“ + Element Plus UI
- **éƒ¨ç½²**: Docker + docker-compose
- **åœ°å›¾**: Leafletåœ°å›¾åº“ï¼Œåˆå§‹ä½ç½®æ·±åœ³å¤§å­¦ç²¤æµ·æ ¡åŒº

## åŠŸèƒ½éœ€æ±‚

### 1. ç”¨æˆ·è®¤è¯ç³»ç»Ÿ

#### ç”¨æˆ·è§’è‰²
- **ç®¡ç†å‘˜**: ç®¡ç†ç³»ç»Ÿæ‰€æœ‰åŠŸèƒ½
- **æ™®é€šç”¨æˆ·**: ä½¿ç”¨ç¢³æ±‡ç›‘æµ‹åŠŸèƒ½

#### è®¤è¯åŠŸèƒ½
- **æ³¨å†Œ**: å¼€æ”¾æ³¨å†Œï¼Œç”¨æˆ·åå”¯ä¸€
- **ç™»å½•**: ç”¨æˆ·å+å¯†ç ç™»å½•
- **å¯†ç è¦æ±‚**: å¿…é¡»åŒ…å«æ•°å­—+å¤§å°å†™å­—æ¯
- **å®‰å…¨**: å‰ç«¯åŠ å¯†ä¼ è¾“ï¼Œåç«¯äºŒæ¬¡åŠ å¯†å­˜å‚¨
- **JWT Token**: è¿‡æœŸæ—¶é—´1å¤©ï¼Œæ— è®°ä½æˆ‘åŠŸèƒ½
- **éªŒè¯**: æ— é‚®ç®±éªŒè¯

### 2. æ•°æ®åº“è®¾è®¡

#### ç”¨æˆ·è¡¨ (users)
```
id: integer (ä¸»é”®)
username: varchar(50) (å”¯ä¸€)
email: varchar(100)
password_hash: varchar(255)
role: enum('admin', 'user')
created_at: timestamp
is_active: boolean
```

#### ç¢³æ±‡ç›‘æµ‹åŒºè¡¨ (carbon_zones)
```
id: integer (ä¸»é”®)
name: varchar(20) (2-20å­—ç¬¦)
coordinates: json (å¤šè¾¹å½¢åæ ‡æ•°ç»„)
area: decimal (å¹³æ–¹ç±³)
status: enum('active', 'inactive') (ç›‘æµ‹ä¸­/åœæ­¢ç›‘æµ‹)
created_at: timestamp
user_id: integer (å¤–é”®)
```

#### ç¢³æ±‡ä»·æ ¼è¡¨ (carbon_prices)
```
id: integer (ä¸»é”®)
price: decimal (å…ƒ/å¨)
timestamp: timestamp
source: varchar(100)
```

#### ç›‘æµ‹æ•°æ®è¡¨ (zone_measurements)
```
id: integer (ä¸»é”®)
zone_id: integer (å¤–é”®)
ndvi: decimal (å½’ä¸€åŒ–æ¤è¢«æŒ‡æ•°)
carbon_absorption: decimal (å¨/å¤©)
timestamp: timestamp
```

### 3. åœ°å›¾åŠŸèƒ½

#### åŸºæœ¬è®¾ç½®
- **åœ°å›¾åº“**: Leaflet
- **åˆå§‹ä½ç½®**: æ·±åœ³å¤§å­¦ç²¤æµ·æ ¡åŒº (22.5828Â°N, 113.9686Â°E)
- **ç¼©æ”¾çº§åˆ«**: é»˜è®¤16çº§
- **åæ ‡ç²¾åº¦**: 6ä½å°æ•°

#### åŒºåŸŸåˆ›å»º
- **ç‚¹é™åˆ¶**: æœ€å¤š7ä¸ªç‚¹å›´æˆå¤šè¾¹å½¢
- **é¼ æ ‡æ ·å¼**: åˆ›å»ºæ—¶æ˜¾ç¤ºæ©™çº¢è‰²æ‰å¹³åŒ–å›å½¢é’ˆå›¾æ ‡
- **äº¤äº’**: ç‚¹å‡»åœ°å›¾æ”¾ç½®ç‚¹ï¼Œè‡ªåŠ¨è¿çº¿å½¢æˆå¤šè¾¹å½¢
- **å®Œæˆæ–¹å¼**: é€šè¿‡å·¦ä¾§dashboardçš„"å®Œæˆ"æŒ‰é’®ç»ˆæ­¢åˆ›å»º
- **é¢ç§¯è®¡ç®—**: è‡ªåŠ¨è®¡ç®—å¤šè¾¹å½¢é¢ç§¯ï¼ˆå¹³æ–¹ç±³ï¼‰

#### åŒºåŸŸç®¡ç†
- **ç¼–è¾‘åŠŸèƒ½**: ä¿®æ”¹è¾¹ç•Œç‚¹ä½ç½®
- **åˆ é™¤åŠŸèƒ½**: åˆ é™¤æ•´ä¸ªç›‘æµ‹åŒº
- **çŠ¶æ€ç®¡ç†**: å¯åŠ¨/åœæ­¢ç›‘æµ‹

### 4. DashboardåŠŸèƒ½

#### å·¦ä¾§é¢æ¿
- **å®æ—¶ä»·æ ¼**: æ˜¾ç¤ºå½“å‰ç¢³æ±‡ä»·æ ¼ï¼ˆå…ƒ/å¨ï¼‰
- **åˆ›å»ºæŒ‰é’®**: è§¦å‘åˆ›å»ºç¢³æ±‡ç›‘æµ‹åŒºæ¨¡å¼
- **åŒºåŸŸåˆ—è¡¨**: æ˜¾ç¤ºç”¨æˆ·åˆ›å»ºçš„æ‰€æœ‰ç›‘æµ‹åŒº

#### åŒºåŸŸåˆ—è¡¨é¡¹æ˜¾ç¤º
- åˆ›å»ºæ—¶é—´
- åŒºåŸŸé¢ç§¯ï¼ˆå¹³æ–¹ç±³ï¼‰
- æ€»ç¢³æ±‡å€¼ï¼ˆåŸºäºå†å²æ•°æ®ç´¯ç§¯ï¼‰
- å½“å‰NDVIå€¼
- NDVIå†å²æŠ˜çº¿å›¾
- ç¢³å¸æ”¶é‡å†å²æŠ˜çº¿å›¾

#### å·¦ä¸Šæ–¹ä¸ªäººä¸­å¿ƒ
- ç”¨æˆ·ä¿¡æ¯å±•ç¤º
- è´¦å·è®¾ç½®
- ç™»å‡ºåŠŸèƒ½

### 5. æ•°æ®å¯è§†åŒ–

#### å›¾è¡¨ç±»å‹
- **NDVIå†å²è¶‹åŠ¿**: æŠ˜çº¿å›¾
- **ç¢³å¸æ”¶é‡å†å²è¶‹åŠ¿**: æŠ˜çº¿å›¾

#### æ•°æ®æ¥æº
- **ä»·æ ¼æ•°æ®**: å¤–éƒ¨APIè°ƒç”¨ï¼Œæš‚æ—¶ä½¿ç”¨Mockæ•°æ®
- **ç›‘æµ‹æ•°æ®**: åç«¯APIè°ƒç”¨æ•°æ®åº“

### 6. APIè®¾è®¡

#### RESTful APIè§„èŒƒ
- **ç”¨æˆ·è®¤è¯**: `/api/auth/login`, `/api/auth/register`
- **ç¢³æ±‡ç›‘æµ‹åŒº**: `/api/zones/` (CRUDæ“ä½œ)
- **ç›‘æµ‹æ•°æ®**: `/api/measurements/`
- **ä»·æ ¼æ•°æ®**: `/api/prices/`

#### å“åº”æ ¼å¼
```json
{
  "success": true,
  "data": {...},
  "message": "æ“ä½œæˆåŠŸ"
}
```

### 7. æ€§èƒ½å’Œéƒ¨ç½²

#### æ€§èƒ½è¦æ±‚
- **å¹¶å‘ç”¨æˆ·**: å‡ åäººåŒæ—¶ä½¿ç”¨
- **å“åº”æ—¶é—´**: ä¸€èˆ¬æ“ä½œ<2ç§’ï¼Œæ•°æ®æŸ¥è¯¢<5ç§’

#### ç¯å¢ƒé…ç½®
- **å¼€å‘ç¯å¢ƒ**: æœ¬åœ°å¼€å‘é…ç½®
- **ç”Ÿäº§ç¯å¢ƒ**: ç”Ÿäº§éƒ¨ç½²é…ç½®
- **Docker**: å®¹å™¨åŒ–éƒ¨ç½²

#### ç›‘æ§å’Œå‘Šè­¦
- **å¼‚å¸¸æ£€æµ‹**: åŸºç¡€çš„é”™è¯¯æ—¥å¿—è®°å½•
- **æ€§èƒ½ç›‘æ§**: APIå“åº”æ—¶é—´ç›‘æ§

## å¼€å‘è®¡åˆ’

### Phase 1: é¡¹ç›®åŸºç¡€æ¶æ„ âœ…
- [x] åˆ›å»ºé¡¹ç›®ç›®å½•ç»“æ„
- [x] é…ç½®Dockerç¯å¢ƒ
- [x] æ•°æ®åº“åˆå§‹åŒ–è„šæœ¬

### Phase 2: åç«¯åŸºç¡€åŠŸèƒ½ âœ…
- [x] ç”¨æˆ·è®¤è¯API
- [x] æ•°æ®åº“æ¨¡å‹å®šä¹‰
- [x] åŸºç¡€CRUD API

### Phase 3: å‰ç«¯åŸºç¡€ç•Œé¢ âœ…
- [x] ç™»å½•/æ³¨å†Œé¡µé¢
- [x] Dashboardå¸ƒå±€
- [x] åœ°å›¾ç»„ä»¶é›†æˆ

### Phase 4: æ ¸å¿ƒä¸šåŠ¡åŠŸèƒ½ âœ…
- [x] ç¢³æ±‡ç›‘æµ‹åŒºåˆ›å»º
- [x] æ•°æ®å¯è§†åŒ–å›¾è¡¨
- [x] åŒºåŸŸç®¡ç†åŠŸèƒ½
- [x] ç›‘æµ‹æ•°æ®æ¨¡æ‹Ÿç”ŸæˆåŠŸèƒ½

### Phase 5: ä¼˜åŒ–å’Œéƒ¨ç½² ğŸ”„
- [x] å¼€å‘ç¯å¢ƒé…ç½®
- [ ] æ€§èƒ½ä¼˜åŒ–
- [ ] ç”Ÿäº§ç¯å¢ƒé…ç½®
- [ ] éƒ¨ç½²è„šæœ¬
- [ ] åŸºç¡€ç›‘æ§å’Œå¼‚å¸¸æ£€æµ‹

## æ³¨æ„äº‹é¡¹

1. æ‰€æœ‰åæ ‡ä½¿ç”¨WGS84åæ ‡ç³»
2. é¢ç§¯è®¡ç®—ä½¿ç”¨åœ°ç†å¤šè¾¹å½¢é¢ç§¯ç®—æ³•
3. å‰ç«¯éœ€è¦å¤„ç†åœ°å›¾äº¤äº’çš„å¤æ‚çŠ¶æ€
4. åç«¯éœ€è¦å®ç°å®šæ—¶ä»»åŠ¡ç”Ÿæˆæ¨¡æ‹Ÿç›‘æµ‹æ•°æ®
5. ä»·æ ¼æ•°æ®æš‚æ—¶ä½¿ç”¨Mockï¼Œé¢„ç•™å¤–éƒ¨APIæ¥å£